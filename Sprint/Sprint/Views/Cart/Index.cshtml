@using Sprint.ViewModels
@model CartViewModel

@{
    ViewData["Title"] = $"Your Cart";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<h4 class="text-light font-weight-light text-uppercase">Your Cart</h4>

<table class="table">
    <thead>
        <tr>
            <th>
                Game
            </th>
            <th>
                Developer
            </th>
            <th>
                Added On
            </th>
            @if (Model.ContainsGiftItem)
            {
                <th>
                    Gift
                </th>
            }
            <th>
                Price
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model.Items)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.CartItem.Game.Name)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.CartItem.Game.Developer)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.CartItem.AddedOn)
                </td>
                @if (Model.ContainsGiftItem)
                {
                    <td>
                        @if (item.CartItem.ReceivingUserId != Model.User.Id)
                        {
                            <a asp-controller="Wishlist" asp-route-username="@item.CartItem.ReceivingUser.Name" title="View @item.CartItem.ReceivingUser.Name's wishlist">
                                <i class="text-light fa fa-gift" aria-hidden="true"></i>
                                @item.CartItem.ReceivingUser.Name
                            </a>
                        }
                    </td>
                }
                <td>
                    @if (item.Discount != null)
                    {
                        <div class="d-flex">
                            <div class="mr-2">
                                <span class="moist-discount-regular-price text-secondary">@item.CartItem.Game.RegularPrice</span>
                                <span class="moist-discount-price text-light">@item.Discount.DiscountPrice</span>
                            </div>
                            <span class="moist-discount-percent shadow rounded moist-tooltip">
                                @string.Format("{0:0%}", item.Discount.DiscountPrice / item.CartItem.Game.RegularPrice)
                            </span>
                        </div>
                        <small class="text-secondary">
                            <i class="fa fa-clock-o" aria-hidden="true"></i>
                            @(item.Discount.DiscountFinish.ToString("MMM dd h:mm tt"))
                        </small>
                    }
                    else
                    {
                        <h5 class="text-light font-weight-bold">@item.CartItem.Game.RegularPrice</h5>
                    }
                </td>
                <td>
                    @*<a asp-action="Remove" asp-route-id="@item.CartItem.CartGameId">Remove</a>*@
                </td>
            </tr>
        }
    </tbody>
</table>
